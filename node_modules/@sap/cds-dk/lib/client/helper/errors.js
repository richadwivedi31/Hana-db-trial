const { getMessage } = require('./logging');

class CliError extends Error {
    // noinspection JSAnnotator
    constructor(message, { error, command } = {}) {
        const help = command && getCommandHelp(command);
        throw getMessage(message, { error, help });
    }
}

function getCommandHelp(command) {
    const cli = require('../../../bin/cds');
    return cli?.load(command, () => ({ help: '' }))?.help ?? '';
}

module.exports = {
    CliError
};
